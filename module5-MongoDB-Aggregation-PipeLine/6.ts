
// ржарж┐ржХ ржЖржЫрзЗ тАФ ржЖржорж┐ ржмрж╛ржВрж▓рж╛рзЯ ржПржХрзЗ ржПржХрзЗ **MongoDB Aggregation Stages** тАФ `$bucket`, `$sort`, ржЖрж░ `$limit` ржмрзНржпрж╛ржЦрзНржпрж╛ ржХрж░ржЫрж┐ ржЙржжрж╛рж╣рж░ржгрж╕рж╣ред

// ---

// ## 1я╕ПтГг `$bucket` тАФ ржбрж╛ржЯрж╛ ржЧрзНрж░рзБржкрзЗ ржнрж╛ржЧ ржХрж░рж╛ (range ржЕржирзБржпрж╛ржпрж╝рзА)

// **ржХрж╛ржЬ:** ржбрж╛ржЯрж╛ржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ range ржмрж╛ boundary ржЕржирзБржпрж╛ржпрж╝рзА ржнрж╛ржЧ (bucket) ржХрж░рзЗ aggregate ржХрж░рзЗред

// **Structure:**

// ```js
// {
//   $bucket: {
//     groupBy: <expression>,     // ржХрзЛржи ржлрж┐рж▓рзНржб ржмрж╛ ржнрзНржпрж╛рж▓рзБ ржжрж┐рзЯрзЗ ржнрж╛ржЧ рж╣ржмрзЗ
//     boundaries: [ <lower>, <upper>, ... ],  // range ржПрж░ рж╕рзАржорж╛
//     default: "Other",          // ржпрзЗржЧрзБрж▓рзЛ ржХрзЛржирзЛ range-ржП ржкрзЬрзЗржирж╛, рж╕рзЗржЧрзБрж▓рзЛрж░ bucket ржирж╛ржо
//     output: {                  // ржкрзНрж░рждрж┐ржЯрж╛ bucket ржПрж░ ржЬржирзНржп ржХрзЛржи ржХрзЛржи aggregate output ржжрж┐ржмрзЗ
//       count: { $sum: 1 },
//       names: { $push: "$name" }
//     }
//   }
// }
// ```

// **Example:** ржмрзЯрж╕ ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржк ржХрж░рж╛ тАФ

// ```js
// db.students.aggregate([
//   {
//     $bucket: {
//       groupBy: "$age",
//       boundaries: [ 0, 18, 30, 50, 100 ],
//       default: "Other",
//       output: {
//         count: { $sum: 1 },
//         names: { $push: "$name" }
//       }
//     }
//   }
// ])
// ```

// ЁЯУМ ржПржЦрж╛ржирзЗ 0тАУ18, 18тАУ30, 30тАУ50, 50тАУ100 ржмрзЯрж╕ рж░рзЗржЮрзНржЬрзЗ ржЧрзНрж░рзБржк рж╣ржмрзЗред

// ---

// ## 2я╕ПтГг `$sort` тАФ ржбрж╛ржЯрж╛ рж╕рж╛ржЬрж╛ржирзЛ

// **ржХрж╛ржЬ:** ржХрзЛржирзЛ ржлрж┐рж▓рзНржб ржЕржирзБржпрж╛рзЯрзА ascending (`1`) ржмрж╛ descending (`-1`) ржЕрж░рзНржбрж╛рж░рзЗ рж╕рж╛ржЬрж╛рзЯред

// **Example:** ржмрзЯрж╕ ржЕржирзБржпрж╛рзЯрзА ржмрзЬ ржерзЗржХрзЗ ржЫрзЛржЯ рж╕рж╛ржЬрж╛ржирзЛ тАФ

// ```js
// db.students.aggregate([
//   { $sort: { age: -1 } }
// ])
// ```

// ЁЯУМ `-1` ржорж╛ржирзЗ descending (рж╕ржмржЪрзЗрзЯрзЗ ржмрзЬ ржЖржЧрзЗ), `1` ржорж╛ржирзЗ ascendingред

// ---

// ## 3я╕ПтГг `$limit` тАФ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕ржВржЦрзНржпржХ ржбржХрзБржорзЗржирзНржЯ ржирзЗржУрзЯрж╛

// **ржХрж╛ржЬ:** pipeline ржерзЗржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕ржВржЦрзНржпржХ document return ржХрж░рзЗред

// **Example:** ржкрзНрж░ржержо 5 ржЬржи тАФ

// ```js
// db.students.aggregate([
//   { $limit: 5 }
// ])
// ```

// ЁЯУМ `$sort` ржПрж░ ржкрж░рзЗ `$limit` ржжрж┐рж▓рзЗ top N results ржмрзЗрж░ ржХрж░рж╛ ржпрж╛рзЯ (ржпрзЗржоржи Top 5 highest age)ред

// ---

// ### ЁЯОп рждрж┐ржиржЯрж╛ ржПржХрж╕рж╛ржерзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ Example:

// ```js
// db.students.aggregate([
//   { $sort: { age: -1 } },   // ржмрзЯрж╕ descending
//   { $limit: 5 },            // ржкрзНрж░ржержо рзл ржЬржи
//   { $project: { name: 1, age: 1, _id: 0 } } // рж╢рзБржзрзБ name ржЖрж░ age ржжрзЗржЦрж╛ржУ
// ])
// ```

// ЁЯУМ ржПрждрзЗ ржХрж░рзЗ **рж╕ржмржЪрзЗрзЯрзЗ ржмрзЗрж╢рж┐ ржмрзЯрж╕рзЗрж░ рзл ржЬржирзЗрж░ ржирж╛ржо ржУ ржмрзЯрж╕** ржжрзЗржЦрж╛ ржпрж╛ржмрзЗред

// ---

// рждрзБржорж┐ ржЪрж╛ржЗрж▓рзЗ ржЖржорж┐ `$bucket` + `$sort` + `$limit` ржПржХрж╕рж╛ржерзЗ ржирж┐рзЯрзЗ **"Top Age Group Analysis"** ржПрж░ ржПржХржЯрж╛ ржбрзЗржорзЛ рждрзИрж░рж┐ ржХрж░рзЗ ржжрж┐рждрзЗ ржкрж╛рж░рж┐ ржпрж╛рждрзЗ real-life data ржПрж░ ржоржд ржХрж╛ржЬ ржХрж░ржмрзЗред
// ржПрждрзЗ рждрзЛржорж╛рж░ ржмрзЛржЭрж╛ ржЖрж░ржУ ржХрзНрж▓рж┐рзЯрж╛рж░ рж╣ржмрзЗред





//  db.test.aggregate([
            
//             {
//                 $bucket: {
//                       groupBy: "$age",
//                       boundaries: [ 20, 40, 60,80 ],
//                       default: "80 er upore",
//                       output: {
//                         "count": { $sum: 1 },
//                         "titles" : { $push: "$name" }
//                       }
//                     }
//             },
            
//             {
//                 $sort: {age:1}
//             },
//             {
//                 $limit: 3
//             },
//             {
//                 $project: {count:1}
//             }
            
            
            
            
//             ])
          
            
     